/* 
Descrição
Nesta atividade você deve criar uma query que deve retornar o id,nome e a soma total da quantidade de itens dos pedidos de cada pessoa, mas apenas com os 10 usuários com as maiores quantidades de itens devem ser retornados.

O resultado deve estar ordenado de forma descendente pelo total de itens nos pedidos.

Abaixo são disponibilizados os esquemas das tabelas pessoas e pedidos e do resultado da sua consulta SQL.
*/

create database qualifiedSQL;

use qualifiedSQL;

create table pessoas (
	id int primary key,
    nome varchar(50)
);

create table pedidos (
	id int primary key,
    nome_item varchar(50),
    quantidade int,
    pessoas_id int,
    foreign key (pessoas_id) references pessoas(id)
);

insert into pessoas values 
(1, 'Nettie Goldner'),
(2, 'Miss Tianna Brekke'),
(3, 'August Kautzer'),
(4, 'Otto Ryan'),
(5, 'Fleta Hayes'),
(6, 'Olen Howe'),
(7, 'Niko Kirlin'),
(8, 'Nelda Kihn'),
(9, 'Mr. Joseph McClure'),
(10, 'Charlotte Blick'),
(11, 'Mr. Sharon Johnson'),
(12, 'Selena Bednar'),
(13, 'Estel Lemke'),
(14, 'Candida Stokes'),
(15, 'Elsa Kling II'),
(16, 'Mekhi Howell'),
(17, 'Jade Davis'),
(18, 'Chanelle Mohr PhD'),
(19, 'Stewart Torphy'),
(20, 'Miss Amparo Kunze'),
(21, 'Jarvis Balistreri'),
(22, 'Miss Charley Turcotte'),
(23, 'Dr. Ludwig Pouros'),
(24, 'Alysson Romaguera'),
(25, 'Alexandria Strosin'),
(26, 'Allison Fritsch PhD'),
(27, 'Malvina Kiehn'),
(28, 'Eddie Bergstrom'),
(29, 'Demario Cummerata'),
(30, 'Mrs. Ramon Auer'),
(31, 'Jarred Willms Sr.'),
(32, 'Jermain Kling'),
(33, 'Dr. Ceasar Nicolas'),
(34, 'Jules Orn V'),
(35, 'Mrs. Ubaldo Wuckert'),
(36, 'Sister Kreiger'),
(37, 'Christian Shanahan II'),
(38, 'Dr. Jeffry DuBuque'),
(39, 'Jazlyn Upton'),
(40, 'Donato Kunde'),
(41, 'Molly Bauch'),
(42, 'Miss Adeline Bergnaum'),
(43, 'Alda Pouros Jr.'),
(44, 'Bell Sawayn'),
(45, 'Herta Buckridge'),
(46, 'Reta Emard'),
(47, 'Wilhelm Greenfelder II'),
(48, 'Candido Lynch'),
(49, 'Audra Daniel II'),
(50, 'Joshuah Borer');

insert into pedidos values
(1, 'Practical Marble Hat', 34, 1),
(2, 'Ergonomic Linen Table', 53, 2),
(3, 'Rustic Plastic Chair', 34, 3),
(4, 'Enormous Linen Knife', 44, 4),
(5, 'Lightweight Aluminum Hat', 91, 5),
(6, 'Mediocre Steel Shirt', 42, 6),
(7, 'Lightweight Cotton Watch', 83, 7),
(8, 'Gorgeous Iron Shirt', 25, 8),
(9, 'Incredible Copper Hat', 94, 9),
(10, 'Intelligent Marble Gloves', 57, 10),
(11, 'Practical Marble Hat', 43, 11),
(12, 'Practical Concrete Bench', 53, 12),
(13, 'Gorgeous Wool Chair', 29, 13),
(14, 'Synergistic Steel Bottle', 71, 14),
(15, 'Small Steel Watch', 84, 15),
(16, 'Synergistic Wool Bottle', 64, 16),
(17, 'Ergonomic Wooden Shirt', 11, 17),
(18, 'Mediocre Cotton Shoes', 83, 18),
(19, 'Practical Leather Clock', 37, 19),
(20, 'Lightweight Leather Chair', 89, 20),
(21, 'Practical Leather Table', 13, 21),
(22, 'Synergistic Plastic Watch', 89, 22),
(23, 'Ergonomic Wool Coat', 77, 23),
(24, 'Durable Wool Chair', 93, 24),
(25, 'Ergonomic Copper Car', 55, 25),
(26, 'Rustic Bronze Watch', 78, 26),
(27, 'Fantastic Granite Table', 69, 27),
(28, 'Aerodynamic Iron Coat', 44, 28),
(29, 'Small Wooden Clock', 85, 29),
(30, 'Synergistic Leather Table', 50, 30),
(31, 'Synergistic Linen Wallet', 28, 31),
(32, 'Sleek Paper Watch', 87, 32),
(33, 'Heavy Duty Leather Table', 95, 33),
(34, 'Small Leather Car', 70, 34),
(35, 'Aerodynamic Aluminum Hat', 49, 35),
(36, 'Rustic Marble Hat', 86, 36),
(37, 'Lightweight Aluminum Bench', 88, 37),
(38, 'Practical Cotton Wallet', 90, 38),
(39, 'Fantastic Concrete Table', 72, 39),
(40, 'Aerodynamic Marble Watch', 58, 40),
(41, 'Heavy Duty Leather Watch', 95, 41),
(42, 'Rustic Marble Computer', 34, 42),
(43, 'Small Paper Bag', 68, 43),
(44, 'Ergonomic Plastic Wallet', 30, 44),
(45, 'Practical Rubber Hat', 26, 45),
(46, 'Incredible Silk Bag', 29, 46),
(47, 'Incredible Steel Coat', 15, 47),
(48, 'Durable Leather Car', 44, 48),
(49, 'Sleek Linen Hat', 33, 49),
(50, 'Gorgeous Marble Wallet', 16, 50),
(51, 'Lightweight Silk Shirt', 65, 46),
(52, 'Heavy Duty Iron Lamp', 42, 38),
(53, 'Intelligent Granite Chair', 18, 49),
(54, 'Enormous Paper Bag', 22, 29),
(55, 'Lightweight Iron Table', 51, 20),
(56, 'Durable Silk Coat', 74, 38),
(57, 'Lightweight Concrete Clock', 39, 38),
(58, 'Enormous Bronze Bottle', 94, 22),
(59, 'Synergistic Cotton Bench', 99, 50),
(60, 'Durable Cotton Shoes', 65, 23),
(61, 'Synergistic Leather Shirt', 48, 24),
(62, 'Rustic Granite Chair', 99, 44),
(63, 'Practical Granite Plate', 80, 6),
(64, 'Durable Cotton Wallet', 42, 30),
(65, 'Sleek Aluminum Pants', 85, 47),
(66, 'Gorgeous Marble Shoes', 73, 47),
(67, 'Ergonomic Plastic Car', 76, 21),
(68, 'Intelligent Concrete Plate', 89, 39),
(69, 'Aerodynamic Cotton Hat', 46, 42),
(70, 'Awesome Aluminum Computer', 21, 21),
(71, 'Synergistic Plastic Keyboard', 78, 8),
(72, 'Sleek Granite Bag', 67, 47),
(73, 'Sleek Cotton Knife', 47, 25),
(74, 'Mediocre Plastic Hat', 74, 39),
(75, 'Durable Wooden Shirt', 89, 4),
(76, 'Small Plastic Bench', 25, 45),
(77, 'Fantastic Linen Pants', 68, 48),
(78, 'Practical Wool Watch', 15, 39),
(79, 'Intelligent Wool Pants', 97, 30),
(80, 'Lightweight Marble Keyboard', 97, 7),
(81, 'Awesome Aluminum Clock', 96, 42),
(82, 'Fantastic Linen Bottle', 66, 9),
(83, 'Aerodynamic Linen Bag', 32, 28),
(84, 'Synergistic Steel Computer', 29, 27),
(85, 'Small Bronze Coat', 48, 46),
(86, 'Aerodynamic Iron Chair', 97, 36),
(87, 'Enormous Leather Chair', 92, 38),
(88, 'Intelligent Marble Computer', 45, 41),
(89, 'Sleek Linen Keyboard', 23, 11),
(90, 'Mediocre Wooden Pants', 23, 12),
(91, 'Incredible Copper Wallet', 80, 50),
(92, 'Practical Wool Plate', 53, 20),
(93, 'Synergistic Plastic Pants', 27, 26),
(94, 'Synergistic Silk Car', 63, 50),
(95, 'Aerodynamic Paper Knife', 94, 43),
(96, 'Synergistic Silk Chair', 21, 2),
(97, 'Aerodynamic Copper Plate', 14, 26),
(98, 'Synergistic Paper Car', 16, 27),
(99, 'Incredible Concrete Bottle', 69, 27),
(100, 'Enormous Plastic Shirt', 11, 22);

select pessoas.id, pessoas.nome, sum(pedidos.quantidade) as total_itens from pessoas left join pedidos on pessoas.id = pedidos.pessoas_id group by pessoas.id 
order by total_itens desc limit 10;